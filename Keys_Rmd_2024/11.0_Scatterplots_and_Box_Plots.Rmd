---
title: "Lesson 7a key"
author: "Sam Hart & Katherine Brower"
date: "7/17/2022"
output: html_document
---

# Introduction to R: Lesson 7a

# load library/package
```{r}
library(tidyverse)
```

# import data
```{r}
clinical <- read_csv("data/clinical.csv")
```

# basic ggplot step 1: bind data to the plot
```{r}
plot1 <- ggplot(data = clinical) # bind data to plot
# data has binded to the plot but is not visible because aesthetics (step 2) have not been applied yet
```

# basic ggplot step 2: specify aesthetics
```{r}
plot1 <- ggplot(data = clinical, aes(x = cigarettes_per_day, 
                            y = count.ERCC2.signature.mutations)) # specify aesthetics (axes)
plot1
```

# basic ggplot step 3: add a layer of geometry
```{r}
plot1 <- ggplot(data = clinical,
       aes(x = cigarettes_per_day, 
           y = count.ERCC2.signature.mutations)) + 
  geom_point() # add a layer of geometry 
```

# basic ggplot step 3: alternative way to add a layer of geometry
```{r}
plot1 + geom_point()
```

# basic ggplot step 4: alter the coordinate range
```{r}
plot1 + geom_point() +
  coord_cartesian(xlim = c(0, 10), ylim= c(0, 100))
```

# alternative formatting for ggplot 
```{r}
ggplot(clinical) + 
  geom_point(aes(x = cigarettes_per_day, y = count.ERCC2.signature.mutations)) 
```

# create a subsetted data frame of the columns: barcode, cigarettes_per_day, count.ERCC2.signature.mutations
# * remove NAs
```{r}
barcode_CPD_ERCC_count_data <- clinical %>% 
          select(barcode, cigarettes_per_day, count.ERCC2.signature.mutations) %>% 
          drop_na()
```

# create a scatterplot using the subsetted data frame from above (steps 1, 2 and 3)
```{r}
ggplot(barcode_CPD_ERCC_count_data) + 
  geom_point(aes(x = cigarettes_per_day, y = count.ERCC2.signature.mutations))
```

# zoom into a smaller x-axis range (exclude outliers) (step 4)
```{r}
ggplot(barcode_CPD_ERCC_count_data) + 
  geom_point(aes(x = cigarettes_per_day, y = count.ERCC2.signature.mutations)) +
  coord_cartesian(xlim = c(0, 10), ylim = c(0, 400))
```
          
          
# END OF PART 1 DEMO *****           
# subset another data frame to include the columns: barcode, Tobacco.smoking.history, count.ERCC2.signature.mutations
# remove NAs in ERCC2 signature mutations
# restrict to current smokers and lifelong non-smokers
```{r}
barcode_TSH_ERCC2_count_data <- clinical %>% 
  select(barcode, Tobacco.smoking.history, count.ERCC2.signature.mutations) %>% 
  filter(!is.na(count.ERCC2.signature.mutations)) %>% 
  filter(Tobacco.smoking.history %in% c("Current smoker", "Lifelong Non-smoker"))
```

# create a boxplot from the subsetted dataframe above (steps 1, 2, and 3)
```{r}
ggplot(data = barcode_TSH_ERCC2_count_data, # bind data
       aes(x = Tobacco.smoking.history, # specify aesthetic
           y = count.ERCC2.signature.mutations)) + 
  geom_boxplot() # add geometry
```

# create boxplot, adjust y-axis range (step 4)
```{r}
ggplot(data = barcode_TSH_ERCC2_count_data, # bind data
       aes(x = Tobacco.smoking.history, # specify aesthetic
           y = count.ERCC2.signature.mutations)) + 
  geom_boxplot() + # add geometry
  coord_cartesian(ylim = c(0, 125))
```

# add  data, jittered
```{r}
ggplot(data = barcode_TSH_ERCC2_count_data,
       aes(x = Tobacco.smoking.history,
           y = count.ERCC2.signature.mutations)) + 
  geom_boxplot() +
  coord_cartesian(ylim = c(0, 125)) +
  geom_jitter(color = "blue") # adds each datapoint colored blue to the box plot (jitters)
```

# remove outlier points from geom_boxplot()
```{r}
set.seed(1)
ggplot(data = barcode_TSH_ERCC2_count_data,
       aes(x = Tobacco.smoking.history,
           y = count.ERCC2.signature.mutations)) + 
  geom_boxplot(outlier.shape = NA) + # remove points generated by geom_boxplot()
  coord_cartesian(ylim = c(0, 125)) +
  geom_jitter(color = "purple")
```

```{r}
set.seed(1)
plot_w_pointlabel_names <- ggplot(data = barcode_TSH_ERCC2_count_data,
       aes(x = Tobacco.smoking.history,
           y = count.ERCC2.signature.mutations)) + 
  geom_boxplot(outlier.shape = NA) + # remove points generated by geom_boxplot()
  coord_cartesian(ylim = c(0, 125)) +
  geom_jitter(color = "purple")

```
# Will go into this in tomorrow's lesson of changing the labels
#  #print(plot_w_label_names + ggtitle("Tobacco smoking history vs. ERCC2 Signature Mutations"))
# #print(plot_w_label_names + labs(y = "Number of signature ERCC2 Mutations", x = "Tobacco Smoking History"))